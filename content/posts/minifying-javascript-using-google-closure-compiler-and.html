<p>The other day I wrote a small build script for a <a href="http://github.com/badsyntax/jquery-youtube-player">jquery plugin</a> I&#8217;m working on. For every release I needed to minify, package and archive the Javascript. The purpose of creating the build script was to automate the tagging, packaging and archiving of the tagged release.</p>
<p>I&#8217;ve been using the <a href="http://closure-compiler.appspot.com/home">google closure compiler app</a> to compress my Javascript manually, and needed to find a way to automate this so I could add it to my build script. The closure service offers a <a href="http://code.google.com/closure/compiler/docs/gettingstarted_api.html">REST API</a>, which, as you can imagine, got me quite excited. I didn&#8217;t want to include any additional packages in my repo, so this third-party solution was exactly what I was looking for. Next step was to find an elegant way to utilize this API, and ofcourse curl was the answer:</p>
<pre class="prettyprint bash">in=yourfile.js<br/>out=yourfile.min.js<br/><br/>curl -s \<br/>  -d compilation_level=SIMPLE_OPTIMIZATIONS \<br/>  -d output_format=text \<br/>  -d output_info=compiled_code \<br/> --data-urlencode "js_code@${in}" \<br/> <a href="http://closure-compiler.appspot.com/compile">http://closure-compiler.appspot.com/compile</a> \<br/>  &gt; $out</pre>
<p>The above code simply accepts a path to a Javascript file, sends the contents to the compiler service via POST, and then finally saves the response in a min file. The -d parameter specifies a new POST param. &#8212;data-urlencode &#8220;js_code@filename.js&#8221; reads and url-encodes the contents of a file. &#8220;js_code&#8221; is the param name. The following shows the POST request:</p>
<pre class="prettyprint php">Array<br/>(<br/>    [compilation_level] =&gt; SIMPLE_OPTIMIZATIONS<br/>    [output_format] =&gt; text<br/>    [output_info] =&gt; compiled_code<br/>    [js_code] =&gt; var urlencoded = 'javascript';<br/>)<br/><br/></pre>
<p>curl is a very useful tool! Have a look at the <a href="http://github.com/badsyntax/jquery-youtube-player/blob/0.1a1/build/release.sh">full build script</a>. There&#8217;s nothing fancy going on there, but it sure helps when I need to tag and release a new version.</p>